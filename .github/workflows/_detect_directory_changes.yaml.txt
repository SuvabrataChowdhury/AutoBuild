name: Detect Directory Changes

on:
    workflow_call:
        inputs:
            directory-path:
              required: true
              type: string
        outputs:
            is_changed:
                value: ${{jobs.detect-directory-changes.outputs.is_changed}}

jobs:
    detect-directory-changes:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - id: diff
              run: |
                echo 'Checking if contents of ${{inputs.directory-path}} has changed'

                git fetch origin ${{ github.base_ref }}

                if git diff --name-only origin/${{ github.base_ref }} | grep "^${{ inputs.directory-path }}/"; then
                    echo "changed=true" >> $GITHUB_OUTPUT
                else
                    echo "changed=false" >> $GITHUB_OUTPUT
                fi
        outputs:
            is_changed: ${{steps.diff.outputs.changed}}